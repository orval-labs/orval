/**
 * Generated by orval v8.4.1 ðŸº
 * Do not edit manually.
 * Swagger Petstore
 * OpenAPI spec version: 1.0.0
 */
import useSwr from 'swr';
import type { Key, SWRConfiguration } from 'swr';

import type { Error } from '.././model';

/**
 * @summary health check
 */
export const getHealthCheckUrl = () => {
  return `/health`;
};

export const healthCheck = async (options?: RequestInit): Promise<string> => {
  const res = await fetch(getHealthCheckUrl(), {
    ...options,
    method: 'GET',
  });

  const body = [204, 205, 304].includes(res.status) ? null : await res.text();

  const data: string = body ? JSON.parse(body) : {};
  return data;
};

export const getHealthCheckKey = () => [`/health`] as const;

export type HealthCheckQueryResult = NonNullable<
  Awaited<ReturnType<typeof healthCheck>>
>;

/**
 * @summary health check
 */
export const useHealthCheck = <TError = Promise<Error>>(options?: {
  swr?: SWRConfiguration<Awaited<ReturnType<typeof healthCheck>>, TError> & {
    swrKey?: Key;
    enabled?: boolean;
  };
  fetch?: RequestInit;
}) => {
  const { swr: swrOptions, fetch: fetchOptions } = options ?? {};

  const isEnabled = swrOptions?.enabled !== false;
  const swrKey =
    swrOptions?.swrKey ?? (() => (isEnabled ? getHealthCheckKey() : null));
  const swrFn = () => healthCheck(fetchOptions);

  const query = useSwr<Awaited<ReturnType<typeof swrFn>>, TError>(
    swrKey,
    swrFn,
    swrOptions,
  );

  return {
    swrKey,
    ...query,
  };
};
