---
title: MSW
description: Generate Mock Service Worker handlers from OpenAPI
---

Generate [MSW (Mock Service Worker)](https://mswjs.io/) handlers from your OpenAPI specification to mock your API during development and testing.

## Configuration

Set the `mock` option to `true`:

```ts title="orval.config.ts"
import { defineConfig } from 'orval';

export default defineConfig({
  petstore: {
    output: {
      mode: 'single',
      target: './src/api/petstore.ts',
      schemas: './src/api/model',
      mock: true,
    },
    input: {
      target: './petstore.yaml',
    },
  },
});
```

## Generated Output

Orval generates three types of functions:

### 1. Mock Data Generators

Functions that return mocked values using [Faker.js](https://fakerjs.dev/):

```ts
import { faker } from '@faker-js/faker';

export const getShowPetByIdResponseMock = (
  overrideResponse: Partial<Pet> = {},
): Pet => ({
  id: faker.number.int({ min: undefined, max: undefined }),
  name: faker.string.alpha(20),
  tag: faker.string.alpha(20),
  ...overrideResponse,
});
```

Override values as needed:

```ts
const pet = getShowPetByIdResponseMock({ name: 'Buddy' });
// => { id: 7272122785202176, name: "Buddy", tag: "..." }
```

### 2. Request Handlers

Functions that bind mock data to [MSW](https://mswjs.io/) `http.*` handlers using the recommended [`HttpResponse`](https://mswjs.io/docs/api/http-response) class:

```ts
import { HttpResponse, delay, http } from 'msw';
import type { RequestHandlerOptions } from 'msw';

export const getShowPetByIdMockHandler = (
  overrideResponse?:
    | Pet
    | ((info: Parameters<Parameters<typeof http.get>[1]>[0]) => Promise<Pet> | Pet),
  options?: RequestHandlerOptions,
) => {
  return http.get('*/pets/:petId', async (info) => {
    await delay(1000);
    return HttpResponse.json(
      overrideResponse !== undefined
        ? typeof overrideResponse === 'function'
          ? await overrideResponse(info)
          : overrideResponse
        : getShowPetByIdResponseMock(),
      { status: 200 },
    );
  }, options);
};
```

Orval uses the content type from your OpenAPI spec to pick the right `HttpResponse` helper:

| Content type | Response helper |
|---|---|
| `application/json` | `HttpResponse.json()` |
| `application/xml`, `*+xml` | [`HttpResponse.xml()`](https://mswjs.io/docs/api/http-response) |
| `text/html` | [`HttpResponse.html()`](https://mswjs.io/docs/api/http-response) |
| `text/plain`, other `text/*` | `HttpResponse.text()` |
| `application/octet-stream`, `image/*`, etc. | `HttpResponse.arrayBuffer()` |
| No body (204, etc.) | `new HttpResponse(null, { status })` |

### 3. Aggregated Handlers

Functions that combine all handlers for easy setup:

```ts
export const getPetsMock = () => [
  getListPetsMockHandler(),
  getCreatePetsMockHandler(),
  getShowPetByIdMockHandler(),
];
```

## Usage

### Basic Setup

Use the aggregated handler functions with MSW's [`setupServer`](https://mswjs.io/docs/api/setup-server) (Node.js) or [`setupWorker`](https://mswjs.io/docs/api/setup-worker) (browser):

```ts
import { getPetsMock } from './api/petstore.msw';
import { setupServer } from 'msw/node';

const server = setupServer(...getPetsMock());

beforeAll(() => server.listen());
afterEach(() => server.resetHandlers());
afterAll(() => server.close());
```

### Custom Response

Pass static data directly:

```ts
const showPetByIdMockHandler = getShowPetByIdMockHandler({
  id: 1,
  name: 'Custom Pet',
  tag: 'custom',
});
```

### Dynamic Response

Pass a function for dynamic responses based on request data:

```ts
getShowPetByIdMockHandler(async (info) => {
  const petId = info.params.petId;
  return { id: Number(petId), name: `Pet ${petId}`, tag: 'dynamic' };
});
```

### Override with `server.use()` (MSW best practice)

Following the [MSW best practice for network behavior overrides](https://mswjs.io/docs/best-practices/network-behavior-overrides), use `server.use()` to override specific handlers in individual tests while keeping the default happy-path handlers:

```ts
import { http, HttpResponse } from 'msw';

it('handles server error', () => {
  server.use(
    getShowPetByIdMockHandler(() => {
      throw new HttpResponse(null, { status: 500 });
    }),
  );

  // Test error UI...
});
```

### Passing MSW `RequestHandlerOptions`

Each generated handler accepts an optional second `options` parameter (e.g. `{ once: true }`):

```ts
server.use(
  getShowPetByIdMockHandler(myOverride, { once: true }),
);
```

### Testing with Vitest

```ts
import { expect, vi } from 'vitest';
import { getShowPetByIdMockHandler, getShowPetByIdResponseMock } from './api/petstore.msw';

const mockFn = vi.fn();

const handlers = [
  getShowPetByIdMockHandler(async (info) => {
    mockFn(info.params.petId);
    return getShowPetByIdResponseMock();
  }),
];

// ... run test

expect(mockFn).toHaveBeenCalledWith('123');
```

## Base URL

By default, handlers use a wildcard `*` prefix (e.g. `*/pets/:petId`) so they match any host. To use a specific base URL, set `mock.baseUrl`:

```ts title="orval.config.ts"
export default defineConfig({
  petstore: {
    output: {
      mock: {
        type: 'msw',
        baseUrl: 'https://api.example.com',
      },
    },
  },
});
```

This produces handlers like `http.get('https://api.example.com/pets/:petId', ...)`, which aligns with MSW's recommendation to use [absolute URLs](https://mswjs.io/docs/http/intercepting-requests) for precise matching.

## Dynamic Imports

Enable `indexMockFiles` to dynamically import all handlers:

```ts
// node.ts
import * as mocks from './endpoints/index.msw';
import { setupServer } from 'msw/node';

const handlers = Object.entries(mocks).flatMap(([, getMock]) => getMock());
const server = setupServer(...handlers);

export { server };
```

## MSW Best Practices

The generated code follows [MSW best practices](https://mswjs.io/docs/best-practices):

- **`HttpResponse` class** — uses `HttpResponse.json()`, `.xml()`, `.html()`, `.text()`, and `.arrayBuffer()` instead of raw `Response` constructors, as [recommended by MSW](https://mswjs.io/docs/api/http-response). The correct helper is chosen based on the first matching content type in your OpenAPI spec.
- **`delay()` function** — uses the standalone `delay()` import (not the legacy `ctx.delay`), configurable per-operation or globally.
- **Handler structure** — each handler is a factory function returning `http.get/post/...()`, which can be spread into `setupServer()` or `setupWorker()`.
- **Runtime overrides** — use [MSW's `server.use()`](https://mswjs.io/docs/best-practices/network-behavior-overrides) to override individual handlers in tests. The generated handler factories make this easy.
- **No query parameters in predicates** — path predicates never include query strings, per [MSW's guidance](https://mswjs.io/docs/http/intercepting-requests).
- **Path parameters** — OpenAPI `{param}` is converted to MSW's `:param` syntax for correct matching.
